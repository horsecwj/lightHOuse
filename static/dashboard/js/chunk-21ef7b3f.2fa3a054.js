(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-21ef7b3f"],{"159b":function(t,e,n){var a=n("da84"),o=n("fdbc"),r=n("17c2"),i=n("9112");for(var s in o){var d=a[s],l=d&&d.prototype;if(l&&l.forEach!==r)try{i(l,"forEach",r)}catch(t){l.forEach=r}}},"17c2":function(t,e,n){"use strict";var a=n("b727").forEach,o=n("a640")("forEach");t.exports=o?[].forEach:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}},"2d1d":function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return d}));var a=n("e1d2"),o=function(){return a.a.request({url:"/adm/get_category",method:"get"})},r=function(t){return a.a.request({url:"/adm/get_category",method:"get",params:t})},i=function(t){return a.a.request({url:"/adm/add_category",method:"post",data:t})},s=function(t){return a.a.request({url:"/adm/mod_category",method:"post",data:t})},d=function(t){return a.a.request({url:"/adm/del_category",method:"post",data:t})}},"65f0":function(t,e,n){var a=n("861d"),o=n("e8b5"),r=n("b622")("species");t.exports=function(t,e){var n;return o(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!o(n.prototype)?a(n)&&(null===(n=n[r])&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},"6d32":function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));var a=n("e1d2"),o=function(t){return a.a.request({url:"/adm/mod_label",method:"post",data:t})},r=function(){return a.a.request({url:"/adm/get_label",method:"get"})},i=function(t){return a.a.request({url:"/adm/del_label",method:"post",data:t})},s=function(t){return a.a.request({url:"/adm/add_label",method:"post",data:t})}},"71a5":function(t,e,n){"use strict";n.r(e);var a=(n("b0c0"),n("159b"),n("7db0"),n("2d1d")),o=n("caf6"),r=n("6d32"),i=n("5d2d"),s=n("89cb"),d=n("91b6"),l={components:{editor:n("ca72").a},data:function(){return{auth_token:{},cateAll:[],tagAll:[],tags:[],disableRadio:!1,langAll:[{key:"cn",value:"中文"},{key:"en",value:"英文"}],draftLoading:!1,finishLoading:!1,dataForm:{id:0,lang:"cn",status:0,cate_id:0,title:"",summary:"",markdown:"",rich_text:"",created:new Date,updated:new Date,cover:"",hot:null,label:[],game_id:null},dataRules:{title:[{required:!0,message:" ",trigger:"blur"}],summary:[{required:!0,message:" ",trigger:"blur"}]},label_list:[],label_id:[],game_list:[]}},methods:{handleUpload:function(t,e,n){Object(d.a)(t,e,n)},getCate:function(){var t=this;Object(a.e)({lang:this.dataForm.lang}).then((function(e){if(1===e.code){t.cateAll=JSON.parse(JSON.stringify(e.data));for(var n=e.data.length,a=0;a<n;a++){var o=0,r=0,i=t.cateAll[a].parent_id;for(t.cateAll[a].cname=t.cateAll[a].name;e.data[o].id===i&&e.data[o].lang===t.cateAll[a].lang&&(i=e.data[o].parent_id,t.cateAll[a].cname=e.data[o].name+">"+t.cateAll[a].name),!(1===i||r>6);)o>=n?(o=0,r++):o++}}else t.$Message.error({content:e.data,duration:3})}))},initGameLabel:function(){var t=this;Object(r.c)().then((function(e){1===e.code&&(t.label_list=e.data)}))},initGameList:function(){var t=this;Object(s.c)().then((function(e){1===e.code&&(t.game_list=e.data)}))},onChange:function(t){this.dataForm.rich_text=t},emitDraft:function(){var t=this;this.$refs.dataForm.validate((function(e){if(e){if(""===t.dataForm.rich_text)return void t.$Message.warning("请填写内容");t.dataForm.summary=t.dataForm.summary.substring(0,100),t.dataForm.status=1,t.draftLoading=!0,Object(o.a)(t.dataForm).then((function(e){t.draftLoading=!1,1===e.code?t.$Message.success({content:"添加成功",onClose:function(){t.$router.push({name:"post-list",params:{id:t.dataForm.id,lang:t.dataForm.lang}})}}):t.$Message.error({content:e.data,duration:3})}))}}))},emitFinish:function(){var t=this;this.$refs.dataForm.validate((function(e){if(e){if(""===t.dataForm.rich_text)return void t.$Message.warning("请填写内容");t.dataForm.summary=t.dataForm.summary.substring(0,100),t.dataForm.status=2,t.finishLoading=!0,Object(o.a)(t.dataForm).then((function(e){t.finishLoading=!1,1===e.code?t.$Message.success({content:"添加成功",onClose:function(){t.$router.push({name:"post-list",params:{id:t.dataForm.id,lang:t.dataForm.lang}})}}):t.$Message.error({content:e.data,duration:3})}))}}))},onCateChange:function(){this.dataForm.uri="/article?cate_id="+this.dataForm.cate_id+"&id="+this.dataForm.id+"&lang="+this.dataForm.lang},handleChangeChoose:function(t){var e=this;this.dataForm.label=[],t.forEach((function(t){e.label_list.find((function(n){n.id===t&&e.dataForm.label.push(n)}))}))},handleUploadSu:function(t,e){1===t.code&&(this.dataForm.cover=t.data)}},mounted:function(){this.auth_token={Authorization:i.a.getToken()};var t=parseInt(this.$route.params.id);t>0?(this.dataForm.id=t,this.disableRadio=!0):this.dataForm.id=(new Date).getTime();var e=parseInt(this.$route.params.cid);e>0&&(this.dataForm.cate_id=e);var n=this.$route.params.lang;this.dataForm.lang="cn"===n?"en":"cn",this.getCate(),this.initGameLabel(),this.initGameList()}},u=n("2877"),c=Object(u.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Card",{attrs:{"dis-hover":""}},[n("Row",{attrs:{gutter:2}},[n("Col",{attrs:{span:"20"}},[n("Form",{ref:"dataForm",attrs:{rules:t.dataRules,model:t.dataForm,"label-width":80}},[n("FormItem",{staticStyle:{"margin-bottom":"5px"},attrs:{prop:"title",label:"文章标题"}},[n("Input",{staticStyle:{"max-width":"60%"},attrs:{type:"text",placeholder:"请输入标题",maxlength:"100"},model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}}),t._v("   文章ID：   "),n("a",[t._v(t._s(t.dataForm.id))])],1),n("FormItem",{staticStyle:{"margin-bottom":"5px",width:"98%"},attrs:{prop:"summary",label:"文章摘要"}},[n("Row",[n("Input",{attrs:{type:"text",placeholder:"请输入文章摘要"},model:{value:t.dataForm.summary,callback:function(e){t.$set(t.dataForm,"summary",e)},expression:"dataForm.summary"}})],1)],1),n("FormItem",{staticStyle:{"margin-bottom":"15px"},attrs:{prop:"path",label:"标签"}},[n("Select",{staticStyle:{"max-width":"65%"},attrs:{multiple:""},on:{"on-change":t.handleChangeChoose},model:{value:t.label_id,callback:function(e){t.label_id=e},expression:"label_id"}},t._l(t.label_list,(function(e){return n("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.word))])})),1),n("Button",{staticStyle:{position:"absolute",right:"22%"},attrs:{type:"info",loading:t.draftLoading},on:{click:t.emitDraft}},[n("Icon",{attrs:{type:"ios-trash",size:"20"}}),t._v("存草稿 ")],1),t._v("  "),n("Button",{staticStyle:{position:"absolute",right:"12%"},attrs:{type:"warning",loading:t.finishLoading},on:{click:t.emitFinish}},[n("Icon",{attrs:{type:"ios-send",size:"20"}}),t._v("发 布 ")],1),n("Button",{staticStyle:{position:"absolute",right:"2%"},attrs:{to:{name:"post-list"}}},[t._v("返回列表")])],1)],1),n("editor",{attrs:{"api-key":"pnms95lkhfg76fqrpshmbviwsvs9enk6zfwfryerc47bauao","initial-value":t.dataForm.markdown,"output-format":"html",init:{selector:"about_games",language:"zh_CN",height:750,plugins:"link lists image code table colorpicker textcolor wordcount contextmenu",toolbar:"bold italic underline strikethrough | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify|bullist numlist |outdent indent blockquote | undo redo | link unlink image code | removeformat",branding:!1,menubar:!0,images_upload_handler:t.handleUpload}},model:{value:t.dataForm.rich_text,callback:function(e){t.$set(t.dataForm,"rich_text",e)},expression:"dataForm.rich_text"}})],1),n("Col",{attrs:{span:"4"}},[n("Card",{attrs:{"dis-hover":"",bordered:!0}},[n("p",{attrs:{slot:"title"},slot:"title"},[n("Icon",{attrs:{type:"ios-settings-outline"}}),t._v(" 设置 ")],1),n("Form",{ref:"optsForm",attrs:{"label-position":"top"}},[n("FormItem",{attrs:{label:"语言"}},[n("RadioGroup",{on:{"on-change":t.getCate},model:{value:t.dataForm.lang,callback:function(e){t.$set(t.dataForm,"lang",e)},expression:"dataForm.lang"}},t._l(t.langAll,(function(e){return n("Radio",{key:e.key,attrs:{label:"cate",label:e.key,disabled:t.disableRadio}},[t._v("["+t._s(e.value)+"]")])})),1)],1),n("FormItem",{attrs:{label:"分类"}},[n("RadioGroup",{attrs:{vertical:!0},on:{"on-change":t.onCateChange},model:{value:t.dataForm.cate_id,callback:function(e){t.$set(t.dataForm,"cate_id",e)},expression:"dataForm.cate_id"}},t._l(t.cateAll,(function(e){return n("Radio",{key:e.id+"-"+e.lang,attrs:{label:"cate",label:e.id}},[n("Tooltip",{attrs:{content:e.cname,placement:"top-start","max-width":"200"}},[t._v(t._s(e.name))])],1)})),1)],1),n("FormItem",{attrs:{label:"发布日期"}},[n("DatePicker",{attrs:{type:"datetime",placeholder:"选择发布日期和时间",clearable:!1,editable:!1},model:{value:t.dataForm.updated,callback:function(e){t.$set(t.dataForm,"updated",e)},expression:"dataForm.updated"}})],1),n("FormItem",{attrs:{label:"热门"}},[n("Select",{model:{value:t.dataForm.hot,callback:function(e){t.$set(t.dataForm,"hot",e)},expression:"dataForm.hot"}},t._l([0,1,2,3,4,5],(function(e){return n("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),n("FormItem",{attrs:{label:"关联游戏"}},[n("Select",{on:{"on-change":t.handleChangeChoose},model:{value:t.dataForm.game_id,callback:function(e){t.$set(t.dataForm,"game_id",e)},expression:"dataForm.game_id"}},t._l(t.game_list,(function(e){return n("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.game_name))])})),1)],1),n("FormItem",{attrs:{label:"文章封面",prop:"cover"}},[n("Upload",{attrs:{headers:t.auth_token,action:"/adm/fit_img","on-success":t.handleUploadSu,"show-upload-list":!1}},[n("p",{staticStyle:{"text-align":"center"}},[t._v("点击上传")]),n("Avatar",{staticStyle:{"min-width":"170px",height:"100px"},attrs:{shape:"square",src:t.dataForm.cover,size:"large"}})],1)],1),n("br"),n("br")],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=c.exports},"7db0":function(t,e,n){"use strict";var a=n("23e7"),o=n("b727").find,r=n("44d2"),i="find",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),a({target:"Array",proto:!0,forced:s},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),r(i)},"89cb":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return s}));var a=n("e1d2"),o=function(t){return a.a.request({url:"/adm/add_game",method:"post",data:t})},r=function(t){return a.a.request({url:"/adm/del_game",method:"post",data:t})},i=function(t){return a.a.request({url:"/adm/mod_game",method:"post",data:t})},s=function(t){return a.a.request({url:"/adm/get_game",method:"get",params:t})}},"91b6":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n("bc3a"),o=n.n(a),r=n("5d2d"),i=function(t,e,n){var a=new FormData;a.append("file",t.blob(),t.filename()),function(t){return o.a.request({url:"/adm/fit_img",headers:{Authorization:r.a.getToken(),"Content-Type":"multipart/form-data"},method:"post",data:t})}(a).then((function(t){200===t.status?1===t.data.code?e(t.data.data):n(t.data.data):n(t.status)}))}},a640:function(t,e,n){"use strict";var a=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&a((function(){n.call(null,e||function(){throw 1},1)}))}},b727:function(t,e,n){var a=n("0366"),o=n("44ad"),r=n("7b0b"),i=n("50c4"),s=n("65f0"),d=[].push,l=function(t){var e=1==t,n=2==t,l=3==t,u=4==t,c=6==t,m=7==t,p=5==t||c;return function(f,h,g,b){for(var v,y,_=r(f),F=o(_),$=a(h,g,3),C=i(F.length),w=0,k=b||s,S=e?k(f,C):n||m?k(f,0):void 0;C>w;w++)if((p||w in F)&&(y=$(v=F[w],w,_),t))if(e)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return v;case 6:return w;case 2:d.call(S,v)}else switch(t){case 4:return!1;case 7:d.call(S,v)}return c?-1:l||u?u:S}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterOut:l(7)}},c4a9:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var a=function(){return"undefined"!=typeof window?window:t},o=function(){var t=a();return t&&t.tinymce?t.tinymce:null}}).call(this,n("c8ba"))},ca72:function(t,e,n){"use strict";var a=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],o=function(t){return-1!==a.map((function(t){return t.toLowerCase()})).indexOf(t.toLowerCase())},r=function(t,e,n){Object.keys(e).filter(o).forEach((function(a){var o=e[a];"function"==typeof o&&("onInit"===a?o(t,n):n.on(a.substring(2),(function(t){return o(t,n)})))}))},i=function(t,e,n){var a=e.$props.value?e.$props.value:"",o=e.$props.initialValue?e.$props.initialValue:"";n.setContent(a||(e.initialized?e.cache:o)),e.$watch("value",(function(t,a){n&&"string"==typeof t&&t!==a&&t!==n.getContent({format:e.$props.outputFormat})&&n.setContent(t)})),e.$listeners.input&&function(t,e){var n=t.$props.modelEvents?t.$props.modelEvents:null,a=Array.isArray(n)?n.join(" "):n;e.on(a||"change input undo redo",(function(){t.$emit("input",e.getContent({format:t.$props.outputFormat}))}))}(e,n),r(t,e.$listeners,n),e.initialized=!0},s=0,d=function(t){var e=Date.now();return t+"_"+Math.floor(1e9*Math.random())+ ++s+String(e)},l=function(t){return void 0===t||""===t?[]:Array.isArray(t)?t:t.split(" ")},u=function(t,e){return l(t).concat(l(e))},c=function(){return{listeners:[],scriptId:d("tiny-script"),scriptLoaded:!1}},m=function(){var t=c();return{load:function(e,n,a){t.scriptLoaded?a():(t.listeners.push(a),e.getElementById(t.scriptId)||function(t,e,n,a){var o=e.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=t,o.src=n;var r=function(){o.removeEventListener("load",r),a()};o.addEventListener("load",r),e.head&&e.head.appendChild(o)}(t.scriptId,e,n,(function(){t.listeners.forEach((function(t){return t()})),t.scriptLoaded=!0})))},reinitialize:function(){t=c()}}}(),p=n("c4a9"),f={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return"html"===t||"text"===t}}},h=function(){return(h=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},g=function(t){return function(){var e=h(h({},t.$props.init),{readonly:t.$props.disabled,selector:"#"+t.elementId,plugins:u(t.$props.init&&t.$props.init.plugins,t.$props.plugins),toolbar:t.$props.toolbar||t.$props.init&&t.$props.init.toolbar,inline:t.inlineEditor,setup:function(e){t.editor=e,e.on("init",(function(n){return i(n,t,e)})),t.$props.init&&"function"==typeof t.$props.init.setup&&t.$props.init.setup(e)}});(function(t){return null!==t&&"textarea"===t.tagName.toLowerCase()})(t.element)&&(t.element.style.visibility="",t.element.style.display=""),Object(p.a)().init(e)}},b={props:f,created:function(){this.elementId=this.$props.id||d("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(p.a)())g(this)();else if(this.element&&this.element.ownerDocument){var t=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key",n=function(t){return null==t}(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+t+"/tinymce.min.js":this.$props.tinymceScriptSrc;m.load(this.element.ownerDocument,n,g(this))}},beforeDestroy:function(){null!==Object(p.a)()&&Object(p.a)().remove(this.editor)},deactivated:function(){var t;this.inlineEditor||(this.cache=this.editor.getContent(),null===(t=Object(p.a)())||void 0===t||t.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&g(this)()},render:function(t){return this.inlineEditor?function(t,e,n){return t(n||"div",{attrs:{id:e}})}(t,this.elementId,this.$props.tagName):function(t,e){return t("textarea",{attrs:{id:e},style:{visibility:"hidden"}})}(t,this.elementId)}};e.a=b},caf6:function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return d}));var a=n("e1d2"),o=function(t){return a.a.request({url:"/adm/get_article",method:"get",params:t})},r=function(t){return a.a.request({url:"/adm/get_article",method:"get",params:t})},i=function(t){return a.a.request({url:"/adm/add_article",method:"post",data:t})},s=function(t){return a.a.request({url:"/adm/mod_article",method:"post",data:t})},d=function(t){return a.a.request({url:"/adm/del_article",method:"post",data:t})}},e8b5:function(t,e,n){var a=n("c6b6");t.exports=Array.isArray||function(t){return"Array"==a(t)}}}]);